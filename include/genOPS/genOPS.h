#pragma once
#include <string>
#include <vector>
#include <unordered_map>
#include <iostream>
#include <fstream>
#include "json.hpp"
#include <codecvt>
#include <sstream>

static const Table generationRules = {
    { State::A, {
        { "a", { "aH=SZ;A", "a□□□=□□" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "int P;A", "10□□□" } },
        { "real", { "real P;A", "11□□□" } },
        { "if", { "if(L){A}EZA", "□□□□1□□□3□" } },
        { "else", { "λ", "" } },
        { "while", { "while(L){A}ZA", "4□□□1□□5□" } },
        { "scan", { "scan(aH);A", "□□a□s□□" } },
        { "print", { "print(S);A", "□□□p□□" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::P, {
        { "a", { "aBQ", "6□9" } },
    }},
    { State::Q, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { ",aBQ", "□6□9" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::B, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "[k]C", "□k□□" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "=SZ", "7□=" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::C, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "={SD}", "□□□□8" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::D, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { ",SD", "□□□" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::S, {
        { "a", { "aHVU", " a□□□" } },
        { "k", { "kVU", "k□□" } },
        { "(", { "(S)VU", "□□□□□" } },
        { "-", { "-GVU", "□□-'□                                                                                                                                                                                                                                                              " } },
        { "abs", { "abs(S)VU", "□□□m□□" } },
        { "sqrt", { "sqrt(S)VU", "□□□r□□" } },
        { "ln", { "ln(S)VU", "□□□ln□□" } },
        { "lg", { "lg(S)VU", "□□□lg□□" } },
        { "exp", { "exp(S)VU", "□□□e□□" } },
    }},
    { State::U, {
        { "a", { "λ", " " } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "+TU", "□□+" } },
        { "-", { "-TU", "□□-" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::T, {
        { "a", { "aHV", "a□□" } },
        { "k", { "kV", "k□" } },
        { "(", { "(S)V", "□□□□" } },
        { "-", { "-GV", "□□-'" } },
        { "abs", { "abs(S)V", "□□□m□" } },
        { "sqrt", { "sqrt(S)V", "□□□r□" } },
        { "ln", { "ln(S)V", "□□□ln□" } },
        { "lg", { "lg(S)V", "□□□lg□" } },
        { "exp", { "exp(S)V", "□□□e□" } },
    }},
    { State::V, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "*FV", "□□*" } },
        { "/", { "/FV", "□□/" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::F, {
        { "a", { "aH", "a□" } },
        { "k", { "k", "k" } },
        { "(", { "(S)", "□□□" } },
        { "-", { "-GZ", "□□-'" } },
        { "abs", { "abs(S)", "□□□m" } },
        { "sqrt", { "sqrt(S)", "□□□r" } },
        { "ln", { "ln(S)", "□□□ln" } },
        { "lg", { "lg(S)", "□□□lg" } },
        { "exp", { "exp(S)", "□□□e" } },
    }},
    { State::G, {
        { "a", { "aH", "a□" } },
        { "k", { "k", "k" } },
        { "(", { "(S)", "□□□" } },
        { "abs", { "abs(S)", "□□□m" } },
        { "sqrt", { "sqrt(S)", "□□□r" } },
        { "ln", { "ln(S)", "□□□ln" } },
        { "lg", { "lg(S)", "□□□lg" } },
        { "exp", { "exp(S)", "□□□e" } },
    }},
    { State::H, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "[S]", "□□i" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::L, {
        { "a", { "aHVUOXW", "a□□□□□□" } },
        { "k", { "kVUOXW", "k□□□□□" } },
        { "(", { "(L)XW", "□□□□□" } },
        { "-", { "-GZVUOXW", "□□-'□□□□□" } },
        { "!", { "!(L)XW", "□□□□!□" } },
        { "abs", { "abs(S)VUOXW", "□□□m□□□□□" } },
        { "sqrt", { "sqrt(S)VUOXW", "□□□r□□□□□" } },
        { "ln", { "ln(S)VUOXW", "□□□ln□□□□□" } },
        { "lg", { "lg(S)VUOXW", "□□□lg□□□□□" } },
        { "exp", { "exp(S)VUOXW", "□□□e□□□□□" } },
    }},
    { State::W, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "||MW", "□□||" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::M, {
        { "a", { "aHVUOX", "a□□□□□" } },
        { "k", { "kVUOX", "k□□□□" } },
        { "(", { "(L)X", "□□□□" } },
        { "-", { "-GZVUOX", "□□-'□□□□" } },
        { "!", { "!(L)X", "□□□□!" } },
        { "abs", { "abs(S)VUOX", "□□□m□□□□" } },
        { "sqrt", { "sqrt(S)VUOX", "□□□r□□□□" } },
        { "ln", { "ln(S)VUOX", "□□□ln□□□□" } },
        { "lg", { "lg(S)VUOX", "□□□lg□□□□" } },
        { "exp", { "exp(S)VUOX", "□□□e□□□□" } },
    }},
    { State::X, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "&&NX", "□□&&" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::N, {
        { "a", { "aHVUO", "a□□□□" } },
        { "k", { "kVUO", "k□□□" } },
        { "(", { "(L)", "□□□" } },
        { "-", { "-GZVUO", "□□-'□□□" } },
        { "!", { "!(L)Z", "□□□□!" } },
        { "abs", { "abs(S)VUO", "□□□m□□□" } },
        { "sqrt", { "sqrt(S)VUO", "□□□r□□□" } },
        { "ln", { "ln(S)VUO", "□□□ln□□□" } },
        { "lg", { "lg(S)VUO", "□□□lg□□□" } },
        { "exp", { "exp(S)VUO", "□□□e□□□" } },
    }},
    { State::O, {
        { "<", { "<SZ", "□□<" } },
        { "<=", { "<=SZ", "□□<=" } },
        { "!=", { "!=SZ", "□□!=" } },
        { "==", { "==SZ", "□□==" } },
        { ">=", { ">=SZ", "□□>=" } },
        { ">", { ">SZ", "□□>" } },
    }},
    { State::E, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "else{A}", "2□□□" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
    { State::Z, {
        { "a", { "λ", "" } },
        { "k", { "λ", "" } },
        { "(", { "λ", "" } },
        { ")", { "λ", "" } },
        { "[", { "λ", "" } },
        { "]", { "λ", "" } },
        { "{", { "λ", "" } },
        { "}", { "λ", "" } },
        { ",", { "λ", "" } },
        { "+", { "λ", "" } },
        { "-", { "λ", "" } },
        { "*", { "λ", "" } },
        { "/", { "λ", "" } },
        { "=", { "λ", "" } },
        { "<", { "λ", "" } },
        { "<=", { "λ", "" } },
        { "!=", { "λ", "" } },
        { "==", { "λ", "" } },
        { ">=", { "λ", "" } },
        { ">", { "λ", "" } },
        { ";", { "λ", "" } },
        { "||", { "λ", "" } },
        { "!", { "λ", "" } },
        { "&&", { "λ", "" } },
        { "int", { "λ", "" } },
        { "real", { "λ", "" } },
        { "if", { "λ", "" } },
        { "else", { "λ", "" } },
        { "while", { "λ", "" } },
        { "scan", { "λ", "" } },
        { "print", { "λ", "" } },
        { "abs", { "λ", "" } },
        { "sqrt", { "λ", "" } },
        { "ln", { "λ", "" } },
        { "lg", { "λ", "" } },
        { "exp", { "λ", "" } },
        { "Ʇ", { "λ", "" } },
    }},
};